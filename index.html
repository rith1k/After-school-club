<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>After School Classes</title>
    <style>

    </style>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.12/dist/vue.js"></script>
    <script src="/js/products.js "></script>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css">
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="/css/homePage-css.css">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
        integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.1.10/vue.min.js"></script>
</head>

<body>
    <div id="app" style="width: 100%;">

        <main class="  justify-content-center">

            <div v-if="showProduct" class="justify-content-center shadow-lg m-5"
                style="background-color: transparent; backdrop-filter: blur 5px;">
                <h1 class=" p-3 mt-5  header  container justify-content-around">After School Classes</h2>

                    <div class="container1 ">
                        <div class="card1 shadow-lg w3-animate-zoom" v-for="(product, index) in sortedProducts"
                            :key="index" v-bind:style="{ background: product.color}">
                            <div class="header">
                                <div class="subject">
                                    <h4 class="name" v-text="product.subject"></h4>
                                    <div class="rate"><span v-for='n in 5-product.rating'><i
                                                class="fas fa-star"></i></span>
                                    </div>
                                </div>
                                <div class="price ">Price <br>
                                    <span>${{product.price}}</span>

                                </div>

                            </div>
                            <br>
                            <div
                                class="image align-content-center border-light  rounded-lg align-items-center w3-center">
                                <img v-bind:src="product.image" class=" img-fluid fa-image w3-image">
                            </div><br>
                            <div class="header">
                                <div class="subject">
                                    <h4 class="name">Location</h4>
                                    <h4 class="name"><span class="far fa-globe"></span>{{product.location}}
                                    </h4>
                                </div>
                                <div class="subject">
                                    <h6 class="name">Stock <br>
                                        <span class="align-content-center align-items-end align-self-end    
                                "> {{product.space}}</span>

                                    </h6>
                                </div>

                            </div>
                            <div class="w3-content align-center align-content-center w3-center p-2 mt-3">

                                <button
                                    class="btn btn-md btn-light btn-lg btn-outline-dark w3-border-black font-weight-bolder  w3-hover-red  align-center"
                                    v-on:click="addtoCart(product)" v-if='product.space>0'>Add to
                                    Cart</button>
                                <button disabled='disabled'
                                    class="btn btn-light btn-outline-dark w3-text-black font-weight-bolder" v-else>Add
                                    to
                                    Cart</button><button disabled='disabled' v-else>Add to Cart</button>

                                <div class=" w3-content align-center align-content-center w3-center mt-4">
                                    <span
                                        class="text-white rounded p-2 text-uppercase align-center font-weight-bold font-weight-bolder bg-danger"
                                        v-if='product.space===0'> All out!</span>
                                    <span class="text-black font-weight-bolder  p-2 rounded"
                                        v-else-if="product.space < 5">
                                        Only
                                        {{product.space}} left!</span>
                                    <span v-else class="text-black font-weight-bolder  p-2 rounded">Buy now!</span>
                                </div>
                            </div>

                        </div>
                    </div>
            </div>

            <div v-else>


                <div class="checkout" v-show="verified">
                    <div class="justify-content-center shadow-lg m-5">
                        <h2 class=" justify-content-center">Checkout</h2>

                        <div class="row  justify-content-center m-5 p-5">

                            <div class="col-4">

                                <div class="p-3">
                                    <input @keypress="isLetter($event)" placeholder="Enter your full name" type="text"
                                        v-model="order.Name">
                                </div>

                                <div class="p-3">
                                    <input type="number" placeholder="Enter Phone Number" v-model.number="order.phone">
                                </div>

                                <div class="p-3">
                                    <h2>Order information</h2>
                                    <p> Name: {{order.Name}}</p>
                                    <p>Phone: {{order.phone}}</p>
                                    <button v-on:click="submitForm">Place Order </button>
                                </div>
                            </div>
                            <div class="col-8 border-left border-dark p-4 w3-border-black pl-3">
                                <h3>Your Cart</h3>
                                <table class="table  table-image pr-5 mr-5">
                                    <thead class=" pr-5 mr-5">
                                        <tr v-if="cart.length===0">
                                            <td> </td>
                                            <td><img src="/images/cart.jpg" class="w3-image" alt=""></td>
                                            <td>
                                                <h2 class=" align-content-center justify-content-center">Cart is Empty
                                                    :(</h2>
                                            </td>
                                        </tr>
                                        <tr v-else>
                                            <th scope="col"></th>
                                            <th scope="col">Product</th>
                                            <th scope="col">Price</th>
                                            <th scope="col">Qty</th>
                                        </tr>
                                    </thead>
                                    <tbody class="pr-5 mr-5">
                                        <tr v-for="item in product" v-if="Math.abs(item.space-cartCount(item)-5)>0">
                                            <td class="">
                                                <img v-bind:src="item.image" class="img-fluid" alt="Sheep">
                                            </td>
                                            <td>{{item.subject}}</td>
                                            <td>{{item.price}}</td>
                                            <td class="qty">{{Math.abs(item.space-5)}}</td>

                                        </tr>
                                    </tbody>

                                </table>
                                <div class="row">
                                    <div class="u-pull-right">
                                        <h5>Total: <span>{{ total | currency }}</span></h5>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>




                </div>


            </div>
    </div>
    </main>

    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.2.4/vue.min.js"></script>
    <script>
        var webstore = new Vue({
            el: "#app",
            data: {
                color: '#151515',
                sitename: "After School Classes",
                product: product,
                showProduct: true,
                order: {
                    Name: '',
                    phone: '',
                },
                subject: '',
                prices: [],
                location: [],
                cart: [],
                showCart1: false,
                searchString: "",
                verified: false,
                sortType: '',
                filter: '',
            },

            methods: {
                sort(type) {
                    this.sortType = type;
                }, isLetter(e) {
                    let char = String.fromCharCode(e.keyCode);
                    if (/^[A-Za-z]+$/.test(char)) return true;
                    else e.preventDefault();
                },
                addtoCart(product) {
                    this.cart.push(product);
                    this.cart.quantity++;
                    product.space--;

                },
                removeFromCart(product) {
                    this.cart.splice(this.cart.indexOf(product), 1);
                    product.space++;
                },
                showCheckout() {
                    this.showProduct = this.showProduct ? false : true;
                },
                submitForm() {
                    alert("Thanks for purchasing, your order has been confirmed!")
                },
                canAddToCart: function (product) {
                    return product.space > this.cartCount(product);
                },
                cartCount(id) {
                    let count = 0;
                    for (let i = 0; i < this.cart.length; i++) {
                        if (this.cart[i] === id) {
                            count++;

                        }

                    }
                    return count;
                },
            },
            computed: {
                NameValid() {
                    return /^[A-Za-z]+$/.test(this.Name);
                },
                total() {
                    let total = 0;
                    for (let p of this.product) {
                        total += (p.price * (Math.abs(p.space - 5)));
                    } return total;
                },
                cartItemCount: function () {
                    return this.cart.length || '';
                },
                sortedProducts() {

                    console.log(this.sortType);
                    if (this.searchString != "") {
                        var search_array = this.product,
                            searchString = this.searchString;

                        if (!searchString) {
                            return this.product;
                        }
                        searchString = searchString.trim().toLowerCase();

                        search_array = search_array.filter(item => {
                            if (item.subject.toLowerCase().indexOf(searchString) !== -1) {
                                return item;
                            }
                        })
                        return search_array;
                    }
                    if (this.sortType === 'Subject-Low-to-High') {
                        return this.product.sort((a, b) => {
                            if (a.subject < b.subject) return -1;
                            if (a.subject > b.subject) return 1;
                            return 0;
                        });
                    }
                    if (this.sortType === 'Subject-High-to-Low') {
                        return this.product.sort((a, b) => {
                            if (b.subject < a.subject) return -1;
                            if (b.subject > a.subject) return 1;
                            return 0;
                        });
                    }
                    if (this.sortType === 'Location-Low-to-High') {
                        return this.product.sort((a, b) => {
                            if (a.location < b.location) return -1;
                            if (a.location > b.location) return 1;
                            return 0;
                        });
                    }
                    if (this.sortType === 'Location-High-to-Low') {
                        return this.product.sort((a, b) => {
                            if (b.location < a.location) return -1;
                            if (b.location > a.location) return 1;
                            return 0;
                        });

                    }

                    if (this.sortType === 'Availability-Low-to-High') {
                        return this.product.sort((a, b) => {
                            if ((a.space) < (b.space)) return -1;
                            if ((a.space) > (b.space)) return 1;
                            return 0;
                        });
                    }
                    if (this.sortType === 'Availability-High-to-Low') {
                        return this.product.sort((a, b) => {
                            if (b.space < a.space) return -1;
                            if (b.space > a.space) return 1;
                            return 0;
                        });

                    }
                    if (this.sortType === 'Price-Low-to-High') {
                        return this.product.sort((a, b) => {
                            if (a.price < b.price) return -1;
                            if (a.price > b.price) return 1;
                            return 0;
                        });
                    }
                    if (this.sortType === 'Price-High-to-Low') {
                        return this.product.sort((a, b) => {
                            if (b.price < a.price) return -1;
                            if (b.price > a.price) return 1;
                            return 0;
                        });
                    } else {
                        return this.product;

                    }


                }

            }
        });
    </script>

</body>

</html>